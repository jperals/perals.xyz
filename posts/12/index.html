<!DOCTYPE html>
<html lang="en-us">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">

<meta name="description" content="I found it useful for adding custom created_date and modified_date fields to a model without overriding its save method.
I&rsquo;d find a method-based syntax nicer, but it&rsquo;s OK.">

<meta property="og:title" content="Django&#39;s `pre_save` signal" />
<meta property="og:description" content="I found it useful for adding custom created_date and modified_date fields to a model without overriding its save method.
I&rsquo;d find a method-based syntax nicer, but it&rsquo;s OK." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/12/" />
<meta property="article:published_time" content="2018-07-28T22:45:03+00:00" />
<meta property="article:modified_time" content="2018-07-28T22:45:03+00:00" />


<title>


     Django&#39;s `pre_save` signal 

</title>
<link rel="canonical" href="/posts/12/">










<link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500">



<link rel="stylesheet" as="style" onload="this.onload=null;this.rel='stylesheet'"
      href="https://use.fontawesome.com/releases/v5.2.0/css/solid.css"
      integrity="sha384-wnAC7ln+XN0UKdcPvJvtqIH3jOjs9pnKnq9qX68ImXvOGz2JuFoEiCjT8jyZQX2z" crossorigin="anonymous">

<link rel="stylesheet" as="style" onload="this.onload=null;this.rel='stylesheet'"
      href="https://use.fontawesome.com/releases/v5.2.0/css/regular.css"
      integrity="sha384-zkhEzh7td0PG30vxQk1D9liRKeizzot4eqkJ8gB3/I+mZ1rjgQk+BSt2F6rT2c+I" crossorigin="anonymous">

<link rel="stylesheet" as="style" onload="this.onload=null;this.rel='stylesheet'"
      href="https://use.fontawesome.com/releases/v5.2.0/css/brands.css"
      integrity="sha384-nT8r1Kzllf71iZl81CdFzObMsaLOhqBU1JD2+XoAALbdtWaXDOlWOZTR4v1ktjPE" crossorigin="anonymous">

<link rel="stylesheet" as="style" onload="this.onload=null;this.rel='stylesheet'"
      href="https://use.fontawesome.com/releases/v5.2.0/css/fontawesome.css"
      integrity="sha384-HbmWTHay9psM8qyzEKPc8odH4DsOuzdejtnr+OFtDmOcIVnhgReQ4GZBH7uwcjf6" crossorigin="anonymous">


<noscript>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/solid.css"
        integrity="sha384-wnAC7ln+XN0UKdcPvJvtqIH3jOjs9pnKnq9qX68ImXvOGz2JuFoEiCjT8jyZQX2z" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/regular.css"
        integrity="sha384-zkhEzh7td0PG30vxQk1D9liRKeizzot4eqkJ8gB3/I+mZ1rjgQk+BSt2F6rT2c+I" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/brands.css"
        integrity="sha384-nT8r1Kzllf71iZl81CdFzObMsaLOhqBU1JD2+XoAALbdtWaXDOlWOZTR4v1ktjPE" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/fontawesome.css"
        integrity="sha384-HbmWTHay9psM8qyzEKPc8odH4DsOuzdejtnr+OFtDmOcIVnhgReQ4GZBH7uwcjf6" crossorigin="anonymous">
</noscript>








<link rel="shortcut icon"
      
      href="/img/favicon.png"
      
>











<link rel="stylesheet" href="/styles/main.css">

</head>


<body lang="">

<main class="wrapper main">
    <section class="main single" id="projects">
        <div class="container main">
            <div class="content">
                <div class="page-heading">
  <h1>
    
    Django&rsquo;s <code>pre_save</code> signal
    
  </h1>
  
  <div class="meta date">2018-07-28</div>
  
  
  
</div>

                <div class="markdown copy-text">
                    <p>I found it useful for adding custom <code>created_date</code> and <code>modified_date</code> fields to a model without overriding its <em>save</em> method.</p>
<p>I&rsquo;d find a method-based syntax nicer, but it&rsquo;s OK.</p>
<p>This example helped me more than the documentation:</p>
<p><a href="https://www.codingforentrepreneurs.com/blog/post-save-vs-pre-save-vs-override-save-method/">https://www.codingforentrepreneurs.com/blog/post-save-vs-pre-save-vs-override-save-method/</a></p>
<p>Here is how I used it:</p>
<pre><code>from django.db import models
from django.db.models.signals import pre_save
from django.utils import timezone

class Learning(models.Model):
    [...]
    created_date = models.DateTimeField(blank=True)
    modified_date = models.DateTimeField(editable=False)
    [...]


# The fields created_date and modified_date are automatically created/modified but are still editable.
# Approach mostly based on:
# https://stackoverflow.com/questions/1737017/django-auto-now-and-auto-now-add#1737078
# But using pre_save signal instead of overriding the save method, like here:
# https://www.codingforentrepreneurs.com/blog/post-save-vs-pre-save-vs-override-save-method/

def add_dates(sender, instance, *args, **kwargs):
    # On save, update timestamps
    if not instance.id:
        instance.created_date = timezone.now()
    instance.modified_date = timezone.now()


pre_save.connect(add_dates, sender=Learning)
</code></pre>

                </div>
            </div>
            <div class="right">
                <a class="button back-button subtle-button" href="../">
                Back
                </a>
            </div>
        </div>
    </section>
</main>

<nav class="">
    <div class="container">
        
        <a class="nav-sm site-name" href="/">
            perals.xyz
        </a>
        
        <a class="nav-sm menu-link">
            <i class="hamburger-button"></i>
        </a>
        <ul class="section-links">
            <li>
                <a href="/#intro" title="Home">
                    <i class="fas fa-home"></i>
                </a>
            </li>
            
            <li class="primary">
                <a href="/#projects" >
                    Projects
                </a>
            </li>
            
            <li class="primary">
                <a href="/#professional-experience" >
                    Professional experience
                </a>
            </li>
            
            <li class="primary">
                <a href="/#contact" >
                    Contact
                </a>
            </li>
            
            <li class="separator">&nbsp;</li>
            
            <li class="secondary">
                <a href="/posts/" class="active">
                    Blog
                </a>
            </li>
            
        </ul>
    </div>
</nav>
<footer class="site-footer">

    <div class="container">

        <p class="footer-heading">
            <span class="license">
                <a href="https://creativecommons.org/licenses/by/2.0/">
                    <i class="far fa-copyright"></i><span class="small">CC BY</span></a>
            </span>
            <span>&nbsp;Joan Perals Tresserra, 2019</span>
        </p>
        <p class="two-sides-row">
            <span>Made with love and <a href="https://gohugo.io">Hugo</a>.</span>
            <span><a href="https://github.com/jperals/perals.xyz">Source code</a></span>
        </p>

    </div>

</footer>


<script type="text/javascript" src="/scripts/nav.js"></script>


<script type="text/javascript" src="/scripts/changing-text.js"></script>


<script type="text/javascript" src="/scripts/lightbox.js"></script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-7899353-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>

